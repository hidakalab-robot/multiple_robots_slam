<launch>
    <env name="ROSCONSOLE_CONFIG_FILE" value="$(find exploration)/cfg/custom_rosconsole.config"/>

    <arg name="robot_name" default="robot1"/>
    <arg name="multi" default="false"/>
    <arg name="record_rosbag" default="false"/>
    <arg name="use_rosbag" default="false"/>

    <arg name="debug" default="false"/>
    <arg name="rotation" default="true"/>
    <arg name="end_method" default="timer"/>
    <arg name="map_fill" default="false"/>
    
    <!-- <arg unless="$(arg multi)" name="map" default="/$(arg robot_name)/map"/> -->
    <arg unless="$(arg multi)" name="map" default="map_continuity"/>
    <arg if="$(arg multi)" name="map" default="/server/merge_map/grid"/>

    <group ns="$(arg robot_name)">
        <!-- exploration main -->
        <include file="$(find exploration)/launch/includes/frontier_based_exploration.launch.xml">
            <arg name="end" value="end/$(arg end_method)"/>
            <arg name="debug" value="$(arg debug)"/>
            <arg name="rotation" value="$(arg rotation)"/>
            <arg name="robot_name" value="$(arg robot_name)"/>
            <arg unless="$(arg multi)" name="map_frame_id" default="$(arg robot_name)/map"/>
            <arg if="$(arg multi)" name="map_frame_id" default="/server/merge_map"/>
        </include>

        <!-- exploration support -->
        <include file="$(find exploration)/launch/includes/exploration_support.launch.xml">
            <arg name="robot_name" value="$(arg robot_name)"/>
            <arg name="frontier_detection" value="true"/>
            <arg name="branch_detection" value="false"/>
            <arg name="map_fill" value="$(arg map_fill)"/>
            <arg name="orig_map" value="$(arg map)"/>
        </include>

        <!-- rosbag -->
        <include if="$(arg record_rosbag)" file="$(find exploration_support)/launch/rosbag_record.launch">
            <arg name="topics" value="/$(arg robot_name)/map_continuity 
                                        /$(arg robot_name)/pose
                                        /$(arg robot_name)/pose_log/merge
                                        /$(arg robot_name)/scan
                                        /$(arg robot_name)/move_base/global_costmap/costmap
                                        /$(arg robot_name)/rtabmap/mapPath
                                        /tf
                                        /tf_static"/>
            <arg name="compress" value="true"/>
        </include>
    </group>
</launch>
